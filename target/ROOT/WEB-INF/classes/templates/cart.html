<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=0.6">

    <!-- ✅ Load slick CSS ✅ -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.css"
            integrity="sha512-wR4oNhLBHf7smjy0K4oqzdWumd+r5/+6QO/vDda76MW5iug4PT7v86FoEkySIJft3XA0Ae6axhIvHrqwm793Nw=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />

    <!-- ✅ Load slick theme CSS ✅ -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"
            integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />

    <link rel="icon" type="image/ico" href="https://www.vapeshifter.ru/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css">
    <title>Корзина - VapeShifter</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(92179338, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
    <noscript><div><img src="https://mc.yandex.ru/watch/92179338" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->


    <style>
        .loader {
          border: 16px solid #f3f3f3; /* Light grey */
          border-top: 16px solid #3498db; /* Blue */
          border-radius: 50%;
          width: 75px;
          height: 75px;
          animation: spin 2s linear infinite;
        }

        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }


    </style>
</head>

<body style="margin-top:70px; background-color:#eeeeee">
<header th:insert="blocks/header :: Header" ></header>

<br>

<div align="center">
    <div id="loader" style="background-color:#dddddd; width:20%" align="center" class="rounded">
        <div style="width:90%">
            <div class="loader"></div>
        </div>
    </div>

    <!-- ✅ load jQuery ✅ -->
    <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"
    ></script>

    <div align="center" style="font-size:40px;">Корзина</div>

    <div align="center" style="font-size:30px;" th:if="${cartproducts.size()==0}">
        <br>
        Корзина пуста
    </div>

    <table width="100%" th:if="${cartproducts.size()>0}">
        <tr>
            <td align="right" width="50%" style="vertical-align:top">

                <div class="album py-2" align="center">
                    <div class="container">
                        <script th:inline="javascript">
                            /*<![CDATA[*/
                                var total = 0;
                                var totalopt = 0;
                                var totalmass = 0;
                                var oldtotal = 0;
                            /*]]>*/
                        </script>

                        <div th:if="${cartproductsRozn.size()>0}" align="center" style="font-size:30px;">Розничные товары</div>
                        <div style="height:10px"> </div>
                        <div th:each="el:${cartproductsRozn}" class="col">
                                <div th:id="${'cuntent'+el.getId()}" class="card shadow-sm" align="left"  style="width:95%" >

                                        <div style="display: inline-block; vertical-align:middle; margin-left:10%">
                                            <img th:src="${el.getProduct().getPhotoUrl()}" class="" height="150" width="100%" style="object-fit:contain;"/>
                                        </div>
                                        <div class="card-body" style="display: inline-block; vertical-align:middle;" >
                                            <div >
                                                <div align="left" class="mb-0" th:text="${el.getProduct().getTitle()}" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size:20px; color:#222222; width:95%"></div>
                                                <div style="height:10px"> </div>
                                                <div align="left" style="white-space: nowrap;">
                                                    <div style="display:inline-block;">
                                                        <h5  class="text-dark mb-0" th:text="${el.getProduct().getPrice()+' ₽  '}" style="white-space: nowrap;"/>
                                                    </div>

                                                    <script th:inline="javascript">
                                                        /*<![CDATA[*/
                                                            total = total+([[${el.getProduct().getPrice()}]]*[[${el.getQuantity()}]]);

                                                            totalmass = totalmass+([[${el.getProduct().getMass()}]]*[[${el.getQuantity()}]]);

                                                            if([[${el.getProduct().getOldprice()}]]!=null)
                                                                oldtotal = oldtotal+([[${el.getProduct().getOldprice()}]]*[[${el.getQuantity()}]]);
                                                            else
                                                                oldtotal = oldtotal+([[${el.getProduct().getPrice()}]]*[[${el.getQuantity()}]]);

                                                        /*]]>*/
                                                    </script>

                                                    <div th:if="${el.getProduct().getOldprice()!=null}"  style="color:#FF0000; text-decoration: line-through; display:inline-block;">
                                                        <span th:text="${el.getProduct().getOldprice()+' ₽'}" style="font-size:14px; color:#777777; "/>
                                                    </div>
                                                </div>
                                                <div style="height:5px"> </div>

                                                <div align="left" th:if="${el.getProduct().getQuantity()!=null}">
                                                    <i class="mb-0" th:text="${'В наличии: '+el.getProduct().getQuantity()+' шт.'}" style="font-size:15px; color:#444444; "></i>
                                                </div>

                                                <div style="height:15px"> </div>

                                                <div align="left" style="white-space: nowrap;">
                                                    <div style="display:inline-block;">
                                                        <div class="mb-0" style="font-size:17px; color:#222222; white-space: nowrap;">
                                                            Количество:
                                                        </div>
                                                    </div>
                                                    <div style="display:inline-block; width:100px; ">
                                                        <form method="post" th:object="${cart}" th:action="'/cart/'+${el.getId()}+'/edit'">
                                                            <input type="number" min="1" th:max="${el.getProduct().getQuantity()}" th:attr="onchange=|@{showbutt({curid})(curid=${el.getId()})}|" name="quantity" id ="quantity" placeholder="Количество" th:value="${el.getQuantity()}" class="form-control" style="display: inline-block; " required>
                                                            <button style="color:#ffffff; display: none;" th:id="${'cartbutton'+el.getId()}" class="btn btn-success" type="submit">
                                                                <span class="material-symbols-outlined" style="font-size:21px">
                                                                    done
                                                                </span>
                                                            </button>
                                                            <script th:inline="javascript">
                                                                /*<![CDATA[*/

                                                                    function showbutt(curid){
                                                                        document.getElementById("cartbutton"+curid).style.display = "inline-block";
                                                                    }

                                                                /*]]>*/
                                                            </script>
                                                        </form>
                                                    </div>
                                                </div>
                                                <div style="height:10px"> </div>
                                            </div>


                                            <a type="button" class="btn btn-dark" th:href="@{/products/{id}(id=${el.getProduct().getId()})}" style="display: inline-block; font-size:14px;">
                                                Подробнее...
                                            </a>
                                            <a type="button" class="btn btn-danger" href="#" data-toggle="modal" th:data-target="${'#modal'+el.getId().toString()}" style="font-size:14px; display: inline-block; ">
                                                <span class="material-symbols-outlined" style="font-size:17px">
                                                     delete
                                                </span>
                                            </a>

                                            <div class="modal fade" th:id="${'modal'+el.getId().toString()}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                <div class="modal-dialog" role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalLabel">Подтверждение удаления</h5>
                                                            <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close">
                                                            </button>
                                                        </div>
                                                        <div class="modal-body" align="center" >
                                                            Вы уверены что хотите удалить товар из корзины?
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                                                            <form th:action="'/cart/'+${el.getId()}+'/del'" method="post">
                                                                <button type="submit" class="btn btn-danger">
                                                                                 <span class="material-symbols-outlined" style="font-size:15px">
                                                                                 delete
                                                                                 </span>Удалить
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div style="height:10px"> </div>
                                    </div>
                                <div style="height:10px"> </div>

                                <script th:inline="javascript">document.getElementById("cuntent"+"[[${el.getId()}]]").style.display = "block";</script>
                            </div>

                        <div th:if="${cartproductsOpt.size()>0}" align="center" style="font-size:30px;">Оптовые товары</div>
                        <div style="height:10px"></div>
                        <div th:if="${cartproductsOpt.size()>0}" align="center" >
                                    <span style="font-size:20px; vertical-align:text-top; color:#ff7b00" class="material-symbols-outlined">
                                        warning
                                    </span>
                            <span style="vertical-align:text-top">
                                    <i style="font-size:17px; color:#444444; ">
                                        Минимальная сумма оптового заказа - 4000 ₽
                                    </i>
                            </span>
                            <div style="height:10px"></div>
                        </div>
                        <div th:if="${cartproductsOpt.size()>0}" align="center">
                            <div style="display:inline-block;">
                                <div  class="mb-0" style="font-size:20px; color:#222222; ">Общая стоимость оптовых товаров: </div>
                            </div>
                            <div style="display:inline-block;white-space: nowrap; ">
                                <h4 id="totalOptPrice"  style="white-space: nowrap; display:inline-block"></h4>
                                <h4 style="display:inline-block"> ₽</h4>

                            </div>
                        </div>
                        <div style="height:10px"> </div>
                        <div th:each="el:${cartproductsOpt}" class="col">
                            <div th:id="${'cuntent2'+el.getId()}" class="card shadow-sm" align="left"  style="width:95%" >

                                <div style="display: inline-block; vertical-align:middle; margin-left:10%">
                                    <img th:src="${el.getProduct().getPhotoUrl()}" class="" height="200" width="100%" style="object-fit:contain;"/>
                                </div>
                                <div class="card-body" style="display: inline-block; vertical-align:middle;" >
                                    <div >
                                        <div align="left" class="mb-0" th:text="${el.getProduct().getTitle()}" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size:20px; color:#222222; width:95%"></div>
                                        <div style="height:10px"> </div>
                                        <div align="left" style="white-space: nowrap;">
                                            <div style="display:inline-block;">
                                                <h5  class="text-dark mb-0" th:text="${el.getProduct().getPrice()+' ₽  '}" style="white-space: nowrap;"/>
                                            </div>

                                            <script th:inline="javascript">
                                                        /*<![CDATA[*/
                                                            total = total+([[${el.getProduct().getPrice()}]]*[[${el.getQuantity()}]]);

                                                            totalopt = totalopt+([[${el.getProduct().getPrice()}]]*[[${el.getQuantity()}]]);

                                                            totalmass = totalmass+([[${el.getProduct().getMass()}]]*[[${el.getQuantity()}]]);

                                                            if([[${el.getProduct().getOldprice()}]]!=null)
                                                                oldtotal = oldtotal+([[${el.getProduct().getOldprice()}]]*[[${el.getQuantity()}]]);
                                                            else
                                                                oldtotal = oldtotal+([[${el.getProduct().getPrice()}]]*[[${el.getQuantity()}]]);

                                                        /*]]>*/
                                                    </script>

                                            <div th:if="${el.getProduct().getOldprice()!=null}"  style="color:#FF0000; text-decoration: line-through; display:inline-block;">
                                                <span th:text="${el.getProduct().getOldprice()+' ₽'}" style="font-size:14px; color:#777777; "/>
                                            </div>
                                        </div>
                                        <div style="height:5px"> </div>

                                        <div align="left" th:if="${el.getProduct().getQuantity()!=null}">
                                            <i class="mb-0" th:text="${'В наличии: '+el.getProduct().getQuantity()+' шт.'}" style="font-size:15px; color:#444444; "></i>
                                        </div>

                                        <div style="height:15px"> </div>

                                        <div align="left" style="white-space: nowrap;">
                                            <div style="display:inline-block;">
                                                <div class="mb-0" style="font-size:17px; color:#222222; white-space: nowrap;">
                                                    Количество:
                                                </div>
                                            </div>
                                            <div style="display:inline-block; width:100px; ">
                                                <form method="post" th:object="${cart}" th:action="'/cart/'+${el.getId()}+'/edit'">
                                                    <input type="number" min="1" th:max="${el.getProduct().getQuantity()}" th:attr="onchange=|@{showbutt({curid})(curid=${el.getId()})}|" name="quantity"  placeholder="Количество" th:value="${el.getQuantity()}" class="form-control" style="display: inline-block; " required>
                                                    <button style="color:#ffffff; display: none;" th:id="${'cartbutton'+el.getId()}" class="btn btn-success" type="submit">
                                                                <span class="material-symbols-outlined" style="font-size:21px">
                                                                    done
                                                                </span>
                                                    </button>
                                                    <script th:inline="javascript">
                                                                /*<![CDATA[*/

                                                                    function showbutt(curid){
                                                                        document.getElementById("cartbutton"+curid).style.display = "inline-block";
                                                                    }

                                                                /*]]>*/
                                                            </script>
                                                </form>
                                            </div>
                                        </div>
                                        <div style="height:10px"> </div>
                                    </div>


                                    <a type="button" class="btn btn-dark" th:href="@{/products/{id}(id=${el.getProduct().getId()})}" style="display: inline-block; font-size:14px;">
                                        Подробнее...
                                    </a>
                                    <a type="button" class="btn btn-danger" href="#" data-toggle="modal" th:data-target="${'#modal'+el.getId().toString()}" style="font-size:14px; display: inline-block; ">
                                                <span class="material-symbols-outlined" style="font-size:17px">
                                                     delete
                                                </span>
                                    </a>

                                    <div class="modal fade" th:id="${'modal'+el.getId().toString()}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel2">Подтверждение удаления</h5>
                                                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close">
                                                    </button>
                                                </div>
                                                <div class="modal-body" align="center" >
                                                    Вы уверены что хотите удалить товар из корзины?
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
                                                    <form th:action="'/cart/'+${el.getId()}+'/del'" method="post">
                                                        <button type="submit" class="btn btn-danger">
                                                                                 <span class="material-symbols-outlined" style="font-size:15px">
                                                                                 delete
                                                                                 </span>Удалить
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div style="height:10px"> </div>
                            </div>
                            <div style="height:10px"> </div>

                            <script th:inline="javascript">document.getElementById("cuntent2"+"[[${el.getId()}]]").style.display = "block";</script>
                        </div>


                            <script th:inline="javascript">
                                /*<![CDATA[*/
                                if(document.getElementById("totalOptPrice")!=null)
                                    document.getElementById("totalOptPrice").textContent=totalopt;
                                /*]]>*/
                            </script>

                    </div>
                </div>
            </td>
            <td align="left" width="50%" style="vertical-align:top">
                        <div class="card shadow-sm" align="center" style="width:90%; margin-top:60px;">
                            <form method="post" action="/order/addorder" th:object="${orders}">

                                <p style="font-size:20px">Выберите способ получения заказа:</p>
                                <div align="left" style="width:80%;white-space: nowrap; font-size:17px" >


                                    <fieldset >
                                        <span style="white-space: nowrap;">
                                            <input type="radio" id="sam1" onclick="hidepost()"
                                                   name="sposobpoluch" value="sam1">
                                            <label for="sam1" style="white-space: normal; ">Самовывоз c метро
                                                <a target="_blank" href="https://yandex.ru/maps/213/moscow/stops/4419561430/?ll=37.451773%2C55.715169&tab=overview&z=16">Давыдково</a>
                                            </label>
                                        </span>

                                        <script language="JavaScript">
                                            function hidepost(){
                                                var numbertxt=document.getElementById('totalOptPrice');
                                                if(numbertxt!=null){
                                                    if(!(parseInt(numbertxt.textContent, 10)<4000 && parseInt(numbertxt.textContent, 10)>0)){
                                                        document.getElementById("submitorder").disabled=false;
                                                    }
                                                }
                                                else{
                                                    document.getElementById("submitorder").disabled=false;
                                                }

                                                document.getElementById('zipcode').value='';
                                                document.getElementById('adress').value='';
                                                document.getElementById('postdata').style.display='none';
                                                document.getElementById('postprice').textContent='';

                                                document.getElementById("totalPrice").textContent=total+" ₽ ";
                                                document.getElementById("totalOldPrice").textContent=oldtotal+" ₽";



                                                if([[${cartproductsOpt.size()>0}]]){
                                                    document.getElementById('pripoluch').disabled=true;
                                                    document.getElementById('pripoluch').checked=false;
                                                    document.getElementById('yoomoney').checked=true;
                                                }
                                                else
                                                    document.getElementById('pripoluch').disabled=false;
                                            }
                                        </script>
                                        <div style="height:5px"></div>
    <!--                                    <input type="radio" id="sam2"-->
    <!--                                           name="dost" value="sam2">-->
    <!--                                    <label for="sam2">Самовывоз метро 🟢Каширская</label>-->
        <!--<br>-->                     <span style="white-space: nowrap; ">
                                            <input type="radio" id="post" onclick="showpost()"
                                                   name="sposobpoluch" value="post">
                                            <label for="post" style="white-space: normal; ">Отправка по почте России</label>
                                        </span>
                                        <script language="JavaScript">
                                            function showpost(){
                                                document.getElementById('postdata').style.display='block';
                                                document.getElementById("submitorder").disabled=true;

                                                document.getElementById('pripoluch').disabled=true;
                                                document.getElementById('pripoluch').checked=false;
                                                document.getElementById('yoomoney').checked=true;

                                            }
                                        </script>


                                    </fieldset>
                                </div>

<!--                                расчет стоимости-->
                                <div style="width:80%; display:none; " id="postdata">


                                    <div style="height:10px"></div>
                                    Адрес доставки:
                                    <input class="form-control" th:value="${adressatercount}" name="adress" id="adress" placeholder="Ваш точный адрес (город, улица, дом, квартира)" onchange="adressonchange()">

                                    <script language="javascript" >
                                         /*<![CDATA[*/
                                        function adressonchange(){
                                                var numbertxt=document.getElementById('totalOptPrice');
                                                if(numbertxt!=null){
                                                    if(document.getElementById('adress').value.length==0)
                                                        document.getElementById('submitorder').disabled=true;
                                                    else if([[${zip!=null}]] && (parseInt(numbertxt.textContent, 10)>=4000 || parseInt(numbertxt.textContent, 10)==0))
                                                        document.getElementById('submitorder').disabled=false;
                                                }
                                                else{
                                                    if(document.getElementById('adress').value.length==0)
                                                        document.getElementById('submitorder').disabled=true;
                                                    else if([[${zip!=null}]])
                                                        document.getElementById('submitorder').disabled=false;
                                                }
                                        }
                                        /*]]>*/
                                    </script>
                                    Почтовый индекс:
                                    <input class="form-control" name="zipcode" id="zipcode" min="100000" max="999999" maxlength="6" placeholder="Ваш почтовый индекс" type="number" th:value="${zip}" onchange="document.getElementById('submitorder').disabled=true">
                                    <a target="_blank"  href="https://postprice.ru/postal-code/">Узнать свой индекс по адресу</a>
                                    <div style="height:10px"></div>
                                    <a style="color:#ffffff; font-size:16px; width:80%;" class="btn btn-dark" type="button" onclick="pricezip()" >Расчитать стоимость</a>

                                    <script language="javascript" >
                                        function pricezip(){

                                            var zipinurl = document.getElementById('zipcode').value;
                                            var adressinurl = document.getElementById('adress').value;
                                            var promoinurl = document.getElementById('promotitle').value;

                                            if(promoinurl.length==0){
                                                promoinurl='nopromo';
                                            }

                                            if(zipinurl.length<6){
                                                document.getElementById('postprice').textContent='Введен неверный индекс';
                                            }
                                            else{
                                                if(adressinurl.length==0){
                                                    document.getElementById('postprice').textContent='Введен неверный адрес';
                                                }
                                                else{
                                                    var massinurl = totalmass+200;
                                                    var priceinurl = total;
                                                    window.location.href = "/cart/count/"+zipinurl.toString()+"/"+massinurl.toString()+"/"+priceinurl.toString()+"/"+adressinurl.toString()+"/"+promoinurl.toString();
                                                }
                                            }
                                        }
                                    </script>

                                </div>
                                <ul class="nav justify-content-center border-bottom pb-3 mb-3">
                                </ul>


                                <p style="font-size:20px">Выберите способ оплаты:</p>
                                <div align="left" style="width:80%;white-space: nowrap; font-size:17px" >
                                    <fieldset >
                                        <span style="white-space: nowrap;">
                                            <input type="radio" id="yoomoney"
                                                   name="sposoboplaty" value="yoomoney" checked>
                                            <label for="yoomoney" style="white-space: normal; ">
                                                Переводом на эл. кошелек (можно с карты)
                                            </label>
                                        </span>
                                        <div style="height:5px"></div>
                                        <span style="white-space: nowrap; ">
                                            <input type="radio" id="pripoluch"
                                                   name="sposoboplaty" value="pripoluch">
                                            <label for="pripoluch" style="white-space: normal; ">При получении любым способом (только при самовывозе, без опта)</label>
                                        </span>
                                    </fieldset>
                                    <div style="height:5px"></div>
                                    <div align="center">
                                        Промокод:
                                        <input type="text" class="form-control" name="promotitle" id="promotitle" maxlength="20" placeholder="Промокод (необязательно)" th:value="${promo}">
                                    </div>
                                </div>



                                <ul class="nav justify-content-center border-bottom pb-3 mb-3">
                                </ul>
                                <div align="center" style="width:80%">
                                    Комментарий:
                                    <textarea maxlength="512"  name="commentary" id ="commentary" placeholder="Комментарий к заказу (например желаемые вкусы)" class="form-control" style="align:center"></textarea>
                                </div>
                                <ul class="nav justify-content-center border-bottom pb-3 mb-3">
                                </ul>
                                <div >
                                    <div style="height:10px"> </div>


                                    <div style="display:inline-block;" align="left">
                                        <div  class="mb-0" style="font-size:20px; color:#222222; ">Общая стоимость: </div>
                                    </div>
                                    <div style="display:inline-block;">
                                        <h4 class="text-dark mb-0" id="totalPrice"  style="white-space: nowrap;"></h4>
                                        <script th:inline="javascript">
                                            /*<![CDATA[*/
                                                document.getElementById("totalPrice").textContent=total+" ₽ ";
                                            /*]]>*/
                                        </script>

                                    </div>
                                    <div id="oldrizzla" style="color:#FF0000; text-decoration: line-through; display:inline-block;">
                                        <span id="totalOldPrice" style="font-size:17px; color:#777777; "/>
                                    </div>
                                    <div id="postprice" style="display:inline-block; font-size:18px; "></div>

                                    <script th:inline="javascript">
                                            /*<![CDATA[*/
                                                document.getElementById("totalOldPrice").textContent=oldtotal+" ₽";
                                                if(total==oldtotal)
                                                    document.getElementById("oldrizzla").style.display = 'none';
                                            /*]]>*/
                                    </script>
                                    <div style="height:15px"> </div>

                                    <div align="center">
                                        <i class="mb-0" id="totalMass" style="font-size:15px; color:#444444; "></i>
                                    </div>
                                </div>

                                <script th:inline="javascript">
                                            /*<![CDATA[*/
                                                document.getElementById("totalMass").textContent="Вес заказа: "+((totalmass+200)/1000).toString()+" кг.";
                                            /*]]>*/
                                </script>

                                <ul class="nav justify-content-center border-bottom pb-3 mb-3">
                                </ul>

                                <button style="color:#ffffff; font-size:18px; width:66%;" id="submitorder" class="btn btn-success" type="submit">
                                        Оформить заказ
                                </button>




                                <script th:inline="javascript">
                                            /*<![CDATA[*/

                                                if([[${zip==null}]]){
                                                    document.getElementById('sam1').checked=true;
                                                    hidepost();
                                                    document.getElementById('submitorder').disabled=true;
                                                }
                                                else{
                                                    document.getElementById('post').checked=true;
                                                    showpost();

                                                    document.getElementById('postprice').textContent='(+'+[[${postprice}]]+' ₽)';
                                                    document.getElementById('totalPrice').textContent=(parseInt(total, 10)+parseInt([[${postprice}]], 10))+" ₽ ";
                                                    document.getElementById('totalOldPrice').textContent= (parseInt(oldtotal, 10)+parseInt([[${postprice}]], 10))+" ₽ ";

                                                    document.getElementById('submitorder').disabled=false;

                                                    document.getElementById('pripoluch').disabled=true;
                                                    document.getElementById('pripoluch').checked=false;
                                                    document.getElementById('yoomoney').checked=true;

                                                }

                                                var numbertxt=document.getElementById('totalOptPrice');
                                                if(numbertxt!=null){
                                                    if(parseInt(numbertxt.textContent, 10)<4000 && parseInt(numbertxt.textContent, 10)>0){
                                                        document.getElementById('submitorder').disabled=true;
                                                    }
                                                    else{
                                                        document.getElementById('submitorder').disabled=false;
                                                    }
                                                }
                                                else if([[${zip==null}]]){
                                                    document.getElementById('submitorder').disabled=false;
                                                }

                                                if([[${cartproductsOpt.size()>0}]]){
                                                    document.getElementById('pripoluch').disabled=true;
                                                    document.getElementById('pripoluch').checked=false;
                                                    document.getElementById('yoomoney').checked=true;
                                                }

                                            /*]]>*/
                                        </script>
                                <div style="height:20px"> </div>

                            </form>

                        </div>

            </td>
        </tr>
    </table>
    <script>document.getElementById("loader").style.display = "none";</script>

</div>

<footer th:insert="blocks/footer :: Footer"></footer>
</body>
</html>